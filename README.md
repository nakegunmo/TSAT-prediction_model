# BTC価格の極小・極大予測 Transformerモデル

## 概要 🚀

このプロジェクトは、Transformerモデルとソフトラベリング技術を用いて、ビットコイン（BTC）の5分足価格データから、価格の**極小点**（買いシグナル候補）と**極大点**（売りシグナル候補）を予測するためのものです。

モデルは、**分類タスク**（極小/極大/その他）と**回帰タスク**（将来価格の予測）を同時に学習するマルチタスク学習フレームワークを採用しています。

## 主な特徴 ✨

* **Transformerベースのモデル**: 時系列データ内の長期的な依存関係やパターンを捉えるために、Transformer Encoderアーキテクチャを利用します。
* **スコアベースのソフトラベリング**: 単純な「極小=1, 極大=2」といったハードラベルではなく、価格が周囲の価格と比べてどれだけ突出しているかの「度合い」をスコア化し、それを確率分布（ソフトラベル）としてモデルの学習ターゲットとすることで、より曖昧でノイズの多い金融データに対して柔軟な学習を目指します。
* **マルチタスク学習**: 分類損失（KLダイバージェンス）と回帰損失（MSE）を組み合わせることで、モデルがより豊かな特徴表現を学習することを促します。
* **詳細な評価とシミュレーション**: 標準的な分類メトリクスに加え、予測シグナルに基づいた損益（P&L）シミュレーションや、シグナル発生後の価格変動統計など、多角的な評価機能を提供します。
* **柔軟な設定**: 学習やシミュレーションに関する主要なパラメータ（シーケンス長、バッチサイズ、閾値、分析期間など）は、スクリプトの先頭で簡単に変更可能です。
* **メモリ効率の良い予測**: 大規模なデータを扱う際にメモリ不足に陥らないよう、予測処理を小さなバッチに分割して実行する機能を実装しています。

## セットアップと実行方法 🔧

### 1. 前提条件

* Python 3.8+
* PyTorch
* pandas
* NumPy
* scikit-learn
* Matplotlib
* tqdm

必要なライブラリは、以下のコマンドでインストールできます。

```bash
pip install torch pandas numpy scikit-learn matplotlib tqdm
